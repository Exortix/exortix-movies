const baseUrl = 'https://api.themoviedb.org/3/'
const imageBaseUrl = 'https://image.tmdb.org/t/p/w500'
const apiKey = '8de499325df134207967538caa8f36b5'
const user = '1110010 1100101 1110100 1110011 1100001 1101101'
const pass = '1001000 1000110 1000011 1101011 100100 1110101 1100100 101101 100110 111001 1011001 1010100 1110010 1100111 101101 110101 1001110 101101 1011111 100110 1000000 1000000 101010 1010010 1110000 1101101 1101101 1001110 1110011 100011 111101 1011000 1111010 111001 1001000 1010010 1001000 110011 101011 111001 1100111 110010 110100 1010110 1100111 101010 1100111 1110000 1000101 1110010 1010011 1010101 111001 110101 1110110 111000 1101010 1100011 101101 1000101 1110011 1110001 110011 1001101 1100111 100100 110111 1010011 111000 1000000 1010001 1101101 101010 1011010 1101010 1010111 111101 100110 101010 1101110 1100100 1110001 1010100 1001100 1000001 1010001 1010011 100100 1011110 100011 1110110 110101 1001110 1101110 1000011 1100011 1000111 1011010 1110111 1100001 101010 1011010 111111 1010111 111001 111001 1010110 1100010 1110101 1110010 1110111 111000 1000001 110101 111101 1001101 101011 110011 110101 1000010 1100101 110110 111001 1000111 1000010 1111001 101011 1110011 1010011 1001110 1110001 1010001 1010101 1000000 1001101 111101 1010001 111101 1101101 1111010 100100 1010001 1101010 101010 1001100 100100 100100 1001110 110111 1101101 111001 1000000 1010001 101011 1001000 1110101 1100010 1010011 1011111 100100 1001101 1101101 1001100 1101000 1011010 1101010 1000001 1110110 1101000 1100110 100001 110110 1010000 1001110 1110100 1001100 1000001 1110010 1010000 1100100 1001100 1010000 100101 111000 1110001 1101010 110011 101010 1001110 111000 1010000 100001 1101101 1001100 1101011 110010 1010010 1100101 100001 1011110 1000100 1011001 1010111 111111 1000011 1010111 1110000 1000101 1011111 1001101 1100111 1001000 111111 1111001 1001101 1110000 1010110 1100001 100011 1000111 1111000 1001011 1000110 1001011 1010110 101011 100100 101101 1010000 110111 1101000 1010010 101010 1000111 1000010 1111000 100011 1010101 1110010 100001 1111000 100011 1010010 1101101 1111001 1100101 1101110 100001 1000111 1010101 1000000 100101 1000011 1010111 1100111 1111010 1001110 1100110 1011000 101101 1101010 110111 1010111 1011001 101101 100011 111000 110101 110011 110011 100110 101011 1010100 1101110 1010111 1110010 1000011 1000100 1010101 1011000 1100101 1011111 1010000 110100 1110010 1101010 1000100 1010010 1000001 1000010 110011 1101101 1000100 1111001 111000 1110110 1110111 1011111 1000111 101010 1011111 110101 1100100 111111 101011 1101101 1110010 1011000 1000110 1100011 1110110 1011111 1110110 1000011 1100011 1110011 1010101 110110 1110010 1011010 1100100 1001110 110110 1110110 101010 1011010 1101110 1100010 100101 1101011 1010101 110111 101101 100011 110110 1000100 1111010 1100110 110101 1111000 1110010 1110000 111000 111000 1001101 1001100 1010110 101011 101010 1111010 110101 1110010 110100 1100110 1110001 1100010 1010011 111000 1110000 1001010 1110010 1100111 111001 1100011 1000101 1101000 110100 1101110 110010 110101 1001010 1101010 101010 1110100 110011 1010010 1000011 110111 1100110 1000000 1001100 1011010 1110110 1110110 1000011 110110 1001110 1010000 1100110 1001110 1001101 1111010 1010110 1011010 1001110 1010011 100001 1100100 1100101 1000111 110101 1001100 1111010 1110100 1000000 1010001 1100010 1011010 111111 111101 101011 1001100 1000001 1110001 1100100 1110100 110011 1011111 1000001 1010100 110111 100100 1001011 1000001 1000100 1001110 1001110 1101101 1001000 1000010 1000010 1000011 1100100 1110011 110110 101101 1110001 1100110 110100 111000 1100001 1110101 1000011 1100111 1001000 110111 1110000 1101101 1000011 1110010 1000111 1110001 101101 110110 1100010 1110010 1101110 1010101 1010110 1000010 1000111 111111 1110100 110101 1110001 110011 110100 101101 1101000 101101 1110110 1110110 1110100 1001000 100110 110011 1001000 1000111 1011110 1100010 1101101 110111 1011110 1100001 1111001 1001110 1010010 1000011 1111001 1100110 1100100 1001100 1100100 1001110 1011000 111000 1010001 1100011 111001 1000010 111000 1010110 1100001 111101 110100 110110 1000001 1101000 1010010 1001011 1111001 110101 1001101 1010111 1001011 1010110 1101011 1000110 1000111 1000110 1000011 1010001 1001100 1011001 111000 111101 1001010 1011001 1110100 1010010 1011010 1001110 1011111 1011110 1011001 110110 1011001 1000101 1101101 1010001 1001011 1001101 1011010 100110 1010111 101011 100101 1001110 1000101 1110111 1100101 1011110 1110101 1010101 1100111 1000011 1110111 1011010 1100011 110111 1001000 1100001 1001101 1100011 1100110 1110010 110110 1101110 1000011 100110 1100111 110111 1110101 1100110 1011111 1000100 1111010 110011 111001 1101101 110111 1000000 1111000 1010000 1001000 110110 1010100 1010101 1000111 1101101 100011 1110010 1010101 1000000 1011000 1110000 101010 1110111 1000001 1110010 1001110 100011 1001011 1110100 101101 100011 111001 1001101 111000 1101110 1011001 1100001 1001110 101011 111111 110011 1100111 1110011 1100111 1100100 100011 111001 1100110 1001110 1000001 1011001 1100110 1010111 1000001 1101000 1110011 1001100 1111010 1101010 110011 1100111 1001010 101101 101010 100001 100101 1100111 1110001 100101 1000001 1000010 1001000 1010010 111000 101101 1011111 111111 1110010 101010 111111 1000011 100100 1011001 110111 100110 1101000 1011110 1011010 1100111 111000 1110111 1100001 1110100 1011110 1101011 1100100 1101011 1100010 110010 1100010 1010100 111101 111001 111001 1110100 1110000 1100001 1110110 100100 100011 1011010 111111 1001110 1100111 1010110 1110011 1000011 100101 1101101 1000101 1000100 1111001 110101 100110 1110100 1100010 101011 1010001 1001011 1000011 1000010 1100111 1000000 1011111 110101 111000 1101010 1011111 1000010 101011 110100 111111 1010110 100011 1010000 1010001 1111000 110101 110010 1010110 1011010 1011111 100011 111000 1001011 1110001 1100011 1001100 1010010 1110101 100011 1101000 110011 1101101 1010010 1000111 110011 100001 1001011 110110 1110111 1101010 1000101 110111 1100011 100011 1001010 110101 1011010 1101101 1010000 1010111 1001010 110110 1110010 1101101 100101 1100011 1110110 111101 1111010 1110110 1101010 1111010 1111010 1100111 101010 1110101 1101101 1110010 110100 1110110 1000101 110110 1111000 100001 1000101 1101011 1110000 1100101 100001 1110011 1110010 1000001 1110000 1101110 1100110 110100 100011 1110000 1000101 1100100 1011110 1010111 1000110 1100101 110011 1011000 1010011 1100110 110101 1110100 1010010 110100 1110010 1110100 1000110 100101 110111 100101 1010001 1000010 1110000 1001110 1010111 1110100 1010010 1001100 1001000 111000 110010 1010110 1100110 101010 1111001 1000101 1010001 1011001 1001010 1100001 1110101 110010 111101 110110 110101 1100011 100011 1110111 1100001 110110 1001011 1000110 100001 1111010 1101010 1010100 1101010 1000111 1101101 1010110 1010100 1001000 1111000 1111000 1101101 1010110 1001110 101010 1010101 1000110 1101011 1110110 111111 1111010 1001101 1100111 1000101 1011111 100100 1110000 100001 1010100 1010001 111001 1100111 1001100 1101011 1000010 1011111 1111001 1110001 1101110 1110010 111101 1001101 100011 101101 1100110 1110101 101010 1100111 110110 1110000 1101110 1110000 1100011 1010000 1010001 111101 1100110 110101 1110010 110010 111111 1010010 100101 1010011 1010010 1011000 111111 101101 110101 1100101 1111001 110100 1100011 100001 1011110 1000010 1100101 1100001 1001010 1100111 110010 1110000 1110101 1010111 101101 110101 1100101 1001100 101011 1010110 111101 1110110 1011010 1010011 101011 1101101 1101010 1000010 1100010 1110000 1010101 1011111 111101 1001011 1010111 1110010 110101 1001101 1110010 1100100 1010010 1000101 1010001 110101 100100 1011111 1101110 101101 1000001 111000 1101110 1010010 1100101 1010111 1101000 1110011 1000000 100101 1100011 1000001 1001101 1011110 1110011 1111001 1110011 110100 1100010 100101 1110110 1010101 1001011 1101000 1110001 1100010 100110 1101010 110011 1010101 1010100 1001010 1010000 1010110 1101011 1101011 1100001 1010010 111111 100001 1100111 1001100 1000111 1010010 1000100 111000 1101110 1100001 101011 1010011 1101011 1000101 1000001 111111 1000000 1000000 1100001 1011110 111101 1111010 1110110 1110111 1101010 1110000 1011000 1101000 1100110 1010111 111111 1101011 1001101 1100001 1110010 100110 1111000 110110 1010100 1001110 1101000 1110011 1100010 111000 1010110 1011000 100110 101010 1010110 1000010 100001 1110101 1010111 1000100 1100010 100101 1101101 1110101 100001 1100100 1100110 101010 1100111 1111001 100001 1011001 1010111 1000001 100110 1100101 1100001 1110000 1010100 1100100 1110000 110010 1110101 1000011 1100100 1110001 110111 1011111 1010110 1001000 1101110 1010100 110110 1111001 1011010 1010111 1000100 110011 1110101 1010111 1010110 110100 1100101 1100110 1100100 1001000 1110010 1001110 1011000 1101011 100101 1110000 1001101 1010011 100011 1110000 1110100 111111 111101 1000111 1000101 1001100 110110 1010110 1101011 1101110 100011 1101101 100001 101011 1000101 1110100 1001000 1110000 100101 1010101 1110100 1100111 1001011 110010 1001010 1100111 1010100 1100111 1000010 1000110 1110010 1000001 110100 101011 1110000 101011 1010000 1100100 101101 1110111 1101101 1111001 1110100 100101 101011 1110000 1010001 1000001 110010 1110001 1110001 1100010 1110101 1100101 110100 111111 1010000 1010100 100101 1101101 1101010 110100 1000110 1110000 1011110 1010111 110110 1100001 1001100 100101 1100100 1110000 1000110 1110111 1001011 100101 1011111 1110110 1110111 1001100 1010010 1000000 1110010 1101010 100110 1110011 1011111 110111 1110000 110101 1101110 100101 100011 1111001 100101 1101010 1100001 110011 111000 1000001 1101110 1110101 100101 110110 1001110 1011001 1011110 1010110 1101011 100101 1010001 1000110 110111 101101 100110 1100010 100110 110110 1111001 1110001 1000000 1101110 100001 1010011 1000101 1110010 1010111 1000110 1100011 1001100 1010100 111101 1000110 1000011 1010011 1110001 110011 1000110 1101110 1011110 1101110 100100 1010110 101101 1010111 1001100 111000 1100100 1001010 100110 1100100 1001000 1110110 1010110 1010110 1001010 1100010 101101 1110100 110101 111101 1010011 100001 100110 1100110 1111000 1011111 1111010 1110110 110100 1111010 1010101 1010001 1100111 1100111 1100110 1011001 1110010 111111 1001000 1011010 1101000 1110100 1111010 1000011 1110010 110010 111001 1100001 1010110 1110110 1000101 1000010 1001000 101101 110110 110101 111111 1001011 110101 110010 1101010 110010 1010111 111111 1110001 111101 110110 1010110 1100110 100011 1010110 111001 1111010 100110 100011 1101101 1010000 110100 1110011 1110100 1100011 1010101 1010011 1001010 1110001 1110000 1110101 1010010 111000 1000010 1000000 1011000 100110 1001101 1001011 1010101 100100 1010001 100101 1101110 1001010 1011000 1110110 1100101 1100110 100110 1101101 1000001 1101010 1001000 1000111 111101 100110 1110101 1101000 1010111 1000100 111001 1001010 1000001 1100111 1100001 100100 1100110 1010100 1100110 1010010 1011111 1100011 1001010 111111 1101010 1011010 1100001 1000000 1001010 1110110 1110001 1010010 1101000 110010 101010 1010110 1111001 1011111 1110111 100100 1110001 1100010 1111000 111111 100110 1101101 1011010 1100010 110110 111101 1011001 1000111 111000 101010 100100 101011 1010110 1100001 1100110 1000110 110011 1110011 1010100 1010000 100001 110100 111000 1100011 1011010 1100010 1100111 100110 1001010 1011000 1110111 1101000 100011 100001 1010111 111001 1110010 1010100 1000010 111001 1110110 110110 111111 110110 111111 1110010 1001011 1011111 110011 100110 110100 1010010 111000 1101000 1110111 1010100 1011000 1110011 1100011 1010111 101011 1100011 1110000 1001010 1101101 1101101 111111 110101 1110111 1100110 1110101 100110 1011111 1110010 1001110 1101010 1000110 1101000 1100010 1010000 1010010 1011110 1010001 1100001 1011001 1110000 1111000 1101101 1100101 100110 1000011 1011111 1011001 1111001 1010100 1100111 1010010 110101 1100100 110101 1111000 110100 111000 110100 110011 1010010 1011110 1010111 1011010 1010110 1111001 1010111 1110001 100101 1110101 1100100 1010001 1000110 1101110 1100110 1010111 101101 1110111 101011 1110001 1011001 1100110 1100111 110100 1000011 1010001 1110011 1001011 111000 110110 100101 1000101 1010010 1001000 1000110 100101 110100 1010010 1000100 1010111 1010100 1100011 100100 100100 1110011 101101 110111 1100011 1110010 1110100 1100010 1011000 1000001 1000011 1111001 1011110 1010111 100011 1010010 1110001 1010010 100110 1001011 1100011 1001010 110011 1101110 1100011 110010 1011001 1100111 1000110 110110 110110 1100011 1100010 1011000 1101011 1010010 1000010 1000101 111001 1100100 1110111 1110101 1101110 1000001 1000110 1101110 1010100 1011000 1111001 1110111 1000001 1110001 1010011 1100001 1011001 1110110 1000001 111101 1010110 1101110 1001000 1010111 1010010 1010011 1001101 1000101 110110 1000011 1000110 1000100 1010111 1001101 1001000 111111 1001100 111101 1001011 1110101 101101 1101000 1110100 1110000 1001101 100100 1000001 1110111 1010111 1101110 1001000 1010011 1010001 1110111 1110101 1101101 111111 1101011 1111000 1011000 110100 111001 1111001 1010111 1101010 1110010 1001010 1100101 1011010 110010 1010110 100110 1010100 1000001 1100011 1010001 101010 1000101 110111 1100101 1001010 100100 110100 100001 1111000 100011 110010 1110110 1010000 110110 1001101 1100011 1011110 1001100 111101 1010111 1000100 1011110 1001100 1011010 1010000 110111 1100100 1111010 1111001 1001100 1010110 110010 110010 1000111 1001010 111000 1100001 1100111 1100110 1011111 111111 111001 1100111 1010101 1010010 1110110 100100 1010111 1100001 1100011 100101 100011 1010101 100101 1001000 1100001 1101011 1111001 1110001 1010011 100011 1110100 101011 1001100 1001110 1001101 1001110 1010101 100110 100101 1011111 1001110 1011110 101011 100101 1000010 1011110 1001100 100110 1011001 1100001 1100011 1100011 1010110 111000 1101101 1001011 1000001 1010010 1001010 1010001 1001110 1100011 1100101 101101 1110000 1100101 1101010 1111000 1010010 1001010 1010001 1110001 1101011 1111000 111101 110110 1100001 1011111 1110001 1101011 1111000 101011 1010100 1101010 110011 100011 1010011 1011001 1001100 1001101 1100011 1001101 1000100 1101101 1100010 1000101 1100001 1011010 1011001 1110101 1000010 100100 1111000 1100111 111111 110110 1001000 1110001 1101010 1100001 1110101 110010 1101101 1100110 110011 1110101 1110110 1101101 1101010 101011 1010001 1101011 100100 1000000 1011110 1100111 1011000 1111010 1100001 1111010 1000010 1110100 110100 1011000 1000010 1010000 1001101 1010001 1001010 1011000 1100010 1001100 1111001 110011 110010 1110101 1101101 1110110 100011 1100101 1000011 1000001 1110100 110011 1001011 1001101 1111010 1011000 1010011 1110011 1101010 1110110 1011001 101101 101010 1101010 1111010 1100101 1101110 110011 100011 1110111 1111010 1110110 1010001 100011 1111010 1010010 1000101 101101 1000100 1010011 1110111 1000000 1110010 1001101 101011 1001110 1011010 1110100 1101101 1001010 1110011 1100101 1001110 1100011 1001000 1000011 1100100 100001 1000001 111001 1001110 1101110 100100 101011 1000010 1010101 1001011 1100001 1011001 1011001 1101011 1001000 1000010 1010011 1010111 1100110 1010000 1101110 110011 1110101 1110110 1000011 1110110 1001010 1100001 100110 1101010 1010110 1100011 1000100 111101 1101011 111001 1011001 1101101 1010101 1000000 101101 101011 1101000 1100010 1101010 1010110 100101 1100010 1110111 1110011 111101 101010 1110100 1100010 1001101 1001100 1010011 1111010 1011001 1101000 1010100 1100101 1000100 1011111 1110100 1001110 1010101 101010 1101101 1110101 1001010 1000010 1000100 111000 1010010 1010001 1101101 1100110 101010 1001000 100001 1011001 1000110 111000 1000111 1110110 1000010 1100001 1110101 1001011 1000100 1011110 1011110 1110100 1000000 1001110 110111 1000100 1110000 100011 1001110 111000 1100011 111001 1100100 111000 100110 1111010 100001 1010110 1001011 1111001 1111010 1111010 1110111 101011 1110111 1000111 1110001 1111010 100101 1110111 110100 1010010 1110000 1000111 100011 1110000 100101 111000 111001 1101011 1010011 101101 110111 1100001 1010001 1110111 1000110 1011110 1001101 1100111 1110100 1101011 110100 1010001 1101110 1110001 1011001 100101'
var loggedIn;

function text2Binary(string) {
    return string.split('').map(function (char) {
        return char.charCodeAt(0).toString(2);
    }).join(' ');
}
function stringReverse(string) {
    return string.split("").reverse().join("");
}

function login(username, password) {
    if (username == user && password == pass) {
        localStorage.setItem('logindataformovie', `user=${user}&pass=${pass}`);
        console.log(localStorage.getItem('logindataformovie'));
        return true
    } else {
        return false
    }
}

$("#login").submit((e)=>{
    e.preventDefault();
    let status = login(text2Binary(stringReverse($("#login").serializeArray()[0].value)), text2Binary(stringReverse($("#login").
    serializeArray()[1].value)));
    if (status) {
        login(text2Binary(stringReverse($("#login").serializeArray()[0].value)), text2Binary(stringReverse($("#login").
    serializeArray()[1].value)));
        window.location.reload()
    } else {
        alert('failure')
        $.each($("input"), (index,value) => {
            value.value = ''
        });
    }
});
$(document).ready(() => {
    loggedIn = (localStorage.getItem('logindataformovie') == `user=${user}&pass=${pass}`)
    if (loggedIn) {
        loggedInUser()
    }
});

function loggedInUser()
{
document.body.innerHTML =   `
    
<nav class="navbar navbar-dark bg-dark">
    <div class="container">
        <div class="navbar-header">
            <a href="" class="navbar-brand">Exortix Movies</a>
        </div>
        <form action="" id="searchForm">
            <input type="text" name="" id="searchText" class="form-control" placeholder="Search Movies">
        </form>
    </div>
</nav>

<div class="container" style="visibility: hidden;">
    <div class="jumbotron">
        <h3 class="text-center">My<strong>Movie</strong>Search</h3>
        <form action="" id="searchForm">
            <input type="text" name="" id="searchText" class="form-control" placeholder="Search Movies">
        </form>
    </div>
</div>

<div class="container" id="movies">
    <div class="row">
        
    </div>
</div>
<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="js/main.js"></script>
`
$(document).ready(() => {
    $('#searchForm').submit( function(e){ 
        e.preventDefault();
    })
    let searchText = $('#searchText').val();
    getMovies(searchText);
    $('#searchForm').on("input", (e) => {
        searchText = $('#searchText').val();
        getMovies(searchText);
        e.preventDefault();
    });
});

function getMovies(searchText) {
    let searchUrl;
    if (searchText.length < 3)
        searchUrl = `${baseUrl}movie/popular?api_key=${apiKey}&language=en-US&page=1`
    else
        searchUrl = `${baseUrl}search/movie?api_key=${apiKey}&language=en-US&query=${searchText}&page=1&include_adult=false&external_source=imdb_id&append_to_response=external_ids` 
    $.ajax({
        type: "GET",
        url: searchUrl,
        success: function (response) {
            let movies = response.results;
            if (movies.length == 0) {
                $('#movies > .row').html(`<h2>No Results Found!</h2>`);
                return;
            }
            let output = '';
            $.each(movies, (index, movie) => {
                if (movie.poster_path == null)
                    return

                output += `
                    <div class="col movie rounded">
                        <a href='movie/?id=${movie.id}')><img class='rounded' src ='${imageBaseUrl}${movie.poster_path}'
                        onerror="this.src='https://dummyimage.com/500x750/ffffff/000000.jpg&text=no+image';"/></a>
                        <h4>${movie.title}</h4>
                        <p class="movie-overview">${(movie.overview != null) ? movie.overview : ''}</p>
                        <a href='movie/?id=${movie.id}') class="btn btn-secondary">Details</a>
                        <a href='movie/?id=${movie.id}') class="btn btn-primary">Watch</a>
                    </div>
                `;
            });
            
            $('#movies > .row').html(output);
        },
        error: function (xhr,status,error) {
            console.log(error);
        }
    });
}
}